<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Drug Addiction in Malaysia</title>

  <!-- Bootstrap -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css" rel="stylesheet">

  <!-- Load fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Bebas+Neue&family=Montserrat:wght@400;600;700&display=swap" rel="stylesheet">

  <!-- Vega libraries -->
  <script src="https://cdn.jsdelivr.net/npm/vega@5"></script>
  <script src="https://cdn.jsdelivr.net/npm/vega-lite@5"></script>
  <script src="https://cdn.jsdelivr.net/npm/vega-embed@6"></script>

  <link rel="stylesheet" href="https://raw.githubusercontent.com/lemon040805/34003568_w10/refs/heads/main/css/style.css" />

</head>

<body>
  <!-- Header / Hero -->
  <section class="hero">
    <div class="container">
      <div class="title">Drug Addiction in Malaysia</div>
      <p class="subtitle">Interactive visualisations exploring state-level rates and substance composition (2004–2021)</p>
    </div>
  </section>

  <div class="container my-5">
    <!-- Intro -->
    <div class="row justify-content-center mb-4">
      <div class="col-lg-10">
        <div class="card shadow-lg">
          <div class="card-body p-4">
            <h4 class="mb-3">Overview</h4>
            <p class="mb-0">
              This dashboard presents the geographic distribution of drug addiction rates across Malaysian states and the composition
              of reported addiction cases by drug type. Use the year slider to explore changes over time.
            </p>
          </div>
        </div>
      </div>
    </div>

    <!-- Map card -->
    <div class="row justify-content-center mb-4">
      <div class="col-lg-10">
        <div class="card shadow-lg">
          <div class="card-header bg-dark text-white">
            <h5 class="mb-0">Geographic Distribution of Drug Addiction in Malaysia</h5>
          </div>
          <div class="card-body">
            <!-- Vega slider -->
            <div id="map-slider-host" class="slider-host mb-2"></div>

            <div class="viz-wrap">
              <div id="map-viz" class="viz-box"></div>
            </div>

            <hr>
            <div class="text-right source">
              Sources: DOSM (population), AADK (registered drug addicts); basemap: Natural Earth
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Bar card -->
    <div class="row justify-content-center mb-5">
      <div class="col-lg-10">
        <div class="card shadow-lg">
          <div class="card-header bg-dark text-white">
            <h5 class="mb-0">Top Drug Types (Selected Year)</h5>
          </div>
          <div class="card-body">
            <!-- slider -->
            <div id="bar-slider-host" class="slider-host mb-2"></div>

            <div class="viz-wrap">
              <div id="bar-viz" class="viz-box"></div>
            </div>

            <hr>
            <div class="text-right source">
              Source: AADK — drug_type_by_year.csv
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Footer -->
    <div class="row justify-content-center">
      <div class="col-lg-10 text-center text-muted">
        <p class="mb-0"><b>Lim Yue Syuen</b> &middot; FIT3179 — Data Visualisation 2</p>
      </div>
    </div>
  </div>

  <script>
    const mapSpecUrl = "https://raw.githubusercontent.com/lemon040805/34003568_w10/main/js/drug_by_state.vg.json";

    vegaEmbed('#map-viz', mapSpecUrl, { mode: 'vega-lite', actions: false })
      .then(result => {
        // Move any param bindings (sliders) above the viz
        const host = document.getElementById('map-slider-host');
        const bindings = result?.view?.container()?.querySelector('.vega-bindings');
        if (bindings && host) host.appendChild(bindings);
      })
      .catch(console.error);

    // ---- Embed BAR (Top drug types) ----
    const barSpecUrl = "https://raw.githubusercontent.com/lemon040805/34003568_w10/main/js/bar.vg.json";

    vegaEmbed('#bar-viz', barSpecUrl, { mode: 'vega-lite', actions: false })
      .then(result => {
        const host = document.getElementById('bar-slider-host');
        const bindings = result?.view?.container()?.querySelector('.vega-bindings');
        if (bindings && host) host.appendChild(bindings);
      })
      .catch(console.error);
  </script>
</body>
</html>
